<head>
<!-- 画面設計図　スライド10~34 -->
    <title>プラン詳細画面（詳細情報）</title>

    {% load static %}
    <link rel="stylesheet" href="{% static 'plans/plan_detail.css' %}">
</head>

<body>
    <div class="page-title">{{ object.plan_name }}</div>
    <form method="POST" class="form-container">
        {% csrf_token %}

        <div class="tab-menu">
            <button type="button" class="tab-btn" data-target=".tab-memo">メモ</button>

            {% for day in date_list %} 
            <button type="button" class="tab-btn {% if forloop.first %}active{% endif %}" data-target=".tab-schedule-{{ forloop.counter }}">
                {{ day|date:"n/j" }}
            </button>
            {% endfor %}
            
            <button type="button" class="tab-btn" data-target=".tab-detail">詳細情報</button>
            <button type="button" class="tab-btn" data-target=".tab-map">map</button>
            <button type="button" class="tab-btn" data-target=".tab-cost">費用</button>
        </div>    
        
        <!-- 画面設計図　スライド10 プラン詳細画面（詳細情報） -->
        <div class="tab-content tab-detail">
            <p>旅行タイトル</p>
            <p>{{ object.plan_name }}</P>

            <p>出発日</p>
            <p>{{ object.start_date }}</P>

            <p>帰宅日</p>
            <p>{{ object.end_date }}</P>

            <p>予定費用</p>

            <p>実際費用</p>

            <p>メンバーとの共有</p>
            <a class="member-add">メンバーを追加する</a>
            <a href="{% url 'plans:share_revoke' %}" class="revoke-btn">URLを失効</a>

            <a href="{% url 'plans:plan_edit' %}" class="edit-btn">編集</a>
        </div>
        
        <!-- 画面設計図　スライド16 プラン詳細画面（メモ）-->
        <div class="tab-content tab-memo">

            <div class="memo-paper">
                <p class="memo-text" placeholder="アカウント名 入力">
                    初日の集合時間　〇〇駅に8時
                </p>

                <button type="button" class="memo-edit-btn">メモ編集</button>
            </div>

        </div>

        <!-- 画面設計図　スライド18 プラン詳細画面（1日詳細）-->
        {% for day in date_list %}
            <div class="tab-content tab-schedule-{{ forloop.counter }} {% if forloop.first %}active{% endif %}">
                <p>{{ day|date:"n/j" }}の予定</p>
            


                <div class="time">
                    <a href="#" class="schedule-edit-btn">〇〇：〇〇</a>
                </div> 
            
                <div class="destination">
                    <a href="#" class="schedule-detail-btn">目的地名</a>
                </div> 

                <div class="schedule-memo">
                    <p class="memo-text">
                        ・メモはありません。
                    </p>

                    <a href="{% url 'destinations:schedule_memo' %}" class="memo-edit-btn">
                        メモ編集
                    </a>

                </div> 

                <a href="#" class="destination-btn">目的地検索</a>
                <a href="#" class="add-btn">＋</a>

            </div>
        {% endfor %}


        <!-- 画面設計図　スライド29 プラン詳細画面（MAP）-->
        <div class="tab-content tab-map">

            <div class="map-area">
                <div class="map-placeholder">
                    地図（ここにピン表示）
                </div>
            </div>   

        </div>    
         
        <!-- 画面設計図　スライド32 プラン詳細画面（費用）-->
        <div class="tab-content tab-cost">
            
            <!-- 合計金額 -->
            <div class="cost-summary">
                <p class="cost-summary-amount">￥12,000</p>
            </div>
            
            <!-- 費用一覧 -->
            <div class="cost-list">

                <div class="cost-item">
                    <p class="cost-name">交通費</p>
                    <p class="cost-amount">¥3,000</p>
                </div>

                <div class="cost-item">
                    <p class="cost-name">宿泊費</p>
                    <p class="cost-amount">¥7,000</p>
                </div>

                <div class="cost-item">
                    <p class="cost-name">食費</p>
                    <p class="cost-amount">¥2,000</p>
                </div>
            </div>    

            <button type="button" class="cost-add-btn">＋</button>

        </div>

    </form>

    <!-- スライド13　共有URL表示（モーダル）-->
    <div class="share-modal">
        <div class="share-modal-content">
            <button type="button" class="share-modal-close">×</button>

            <p class="share-title">共有URL</p>

            <p class="share-url">
                https://example.com/plan/share?token=xxxx
            </p>
        </div>  
    </div>

    <script>
        document.querySelectorAll('.tab-btn').forEach((btn) =>{
            btn.addEventListener('click', () => {

                // タブの切り替え
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // タブの中身　切り替え
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active')); 
                const target = btn.dataset.target;
                document.querySelector(target).classList.add('active');
            });
        });

        // スライド13　共有URL表示（モーダル）
        const shareModal = document.querySelector('.share-modal');
        const openShareBtn = document.querySelector('.member-add');
        const closeShareBtn = document.querySelector('.share-modal-close');

        if (openShareBtn && shareModal && closeShareBtn){
            openShareBtn.addEventListener('click', () => {
                shareModal.classList.add('active');
            });

            closeShareBtn.addEventListener('click', () => {
                shareModal.classList.remove('active');
            });
        }

    </script>
    

</body>    